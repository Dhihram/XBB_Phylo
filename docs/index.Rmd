---
title: "Supplement Materials"
output:
  html_document:
    toc: true
    toc_float: yes
---

## Pairwise Genetic Distance

``````{r pairwise, echo = FALSE, warning = FALSE, message = FALSE}
library(ape)
library(tidyverse)
library(plotly)
setwd("C:/Users/dhihr/OneDrive - London School of Hygiene and Tropical Medicine/covid/fasta")
mydna <- read.dna('sample_aligment.fasta', as.character = 'TRUE', format = 'fasta')
mydna <- read.FASTA('sample_aligment.fasta')

names(mydna) <- sub("_(\\d{4}_\\d{2}_\\d{2})", "", names(mydna))

#gen distance
data <- ape::dist.dna(mydna, model = "N")
data <- as.matrix(data)
p <- plot_ly(x=colnames(data), y=rownames(data), 
            z = data, 
            type = "heatmap", 
            colorscale = 'Viridis',
            showscale = F) %>%
    layout(margin = list(l=120)) %>%
  layout(
    xaxis = list(tickvals = list(), showticklabels = FALSE),
    yaxis = list(tickvals = list(), showticklabels = FALSE)
  )
p
```



## Phylogenetic Tree

```{r phylo, echo = FALSE, warning = FALSE, message = FALSE}
setwd("C:/Users/dhihr/OneDrive - London School of Hygiene and Tropical Medicine/covid/plot")
p <- readRDS("p3.rds")
p <- plotly::ggplotly(p, tooltip = "text")
p
```


## Transmission Network Reconstruction

```{r transmission, echo = FALSE, warning = FALSE, message = FALSE}
library(htmltools)
recon_path1 <- "C:/Users/dhihr/OneDrive - London School of Hygiene and Tropical Medicine/covid/plot/for ppt 2/recon1.html"
includeHTML(recon_path1)
```
```{r transmission2,  echo = FALSE, warning = FALSE, message = FALSE}
recon_path2 <- "C:/Users/dhihr/OneDrive - London School of Hygiene and Tropical Medicine/covid/plot/for ppt 2/recon2.html"
includeHTML(recon_path2)
```

